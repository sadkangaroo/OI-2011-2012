<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0041)http://www.matrix67.com/blog/archives/276 -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD 
profile="http://gmpg.org/xfn/11"><TITLE>Matrix67: My Blog » Blog Archive » 十个利用矩阵乘法解决的经典题目</TITLE>
<META content="text/html; charset=UTF-8" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.7600.16671"><!-- leave this for stats --><LINK rel=icon 
type=image/x-icon href="http://www.matrix67.com/favicon.ico"><LINK 
rel="shortcut icon" type=image/x-icon 
href="http://www.matrix67.com/favicon.ico"><LINK rel=stylesheet type=text/css 
href="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/style.css" 
media=screen><!--[if lt ie 7]>	
		<link rel="stylesheet" type="text/css" media="screen" href="http://www.matrix67.com/blog/wp-content/themes/CoolMist/ie-win.css" />
	<![endif]--><LINK title="RSS 2.0" rel=alternate type=application/rss+xml 
href="http://www.matrix67.com/blog/feed.asp"><LINK title="RSS .92" rel=alternate 
type=text/xml href="http://www.matrix67.com/blog/feed/rss"><LINK 
title="Atom 0.3" rel=alternate type=application/atom+xml 
href="http://www.matrix67.com/blog/feed/atom"><LINK rel=pingback 
href="http://www.matrix67.com/blog/xmlrpc.php"><LINK title=2010年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2010/10"><LINK title=2010年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2010/09"><LINK 
title=2010年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2010/08"><LINK title=2010年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2010/07"><LINK 
title=2010年六月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2010/06"><LINK title=2010年五月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2010/05"><LINK 
title=2010年四月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2010/04"><LINK title=2010年三月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2010/03"><LINK 
title=2010年二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2010/02"><LINK title=2010年一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2010/01"><LINK 
title=2009年十二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/12"><LINK title=2009年十一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/11"><LINK 
title=2009年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/10"><LINK title=2009年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/09"><LINK 
title=2009年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/08"><LINK title=2009年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/07"><LINK 
title=2009年六月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/06"><LINK title=2009年五月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/05"><LINK 
title=2009年四月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/04"><LINK title=2009年三月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/03"><LINK 
title=2009年二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2009/02"><LINK title=2009年一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2009/01"><LINK 
title=2008年十二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/12"><LINK title=2008年十一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/11"><LINK 
title=2008年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/10"><LINK title=2008年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/09"><LINK 
title=2008年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/08"><LINK title=2008年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/07"><LINK 
title=2008年六月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/06"><LINK title=2008年五月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/05"><LINK 
title=2008年四月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/04"><LINK title=2008年三月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/03"><LINK 
title=2008年二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2008/02"><LINK title=2008年一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2008/01"><LINK 
title=2007年十二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/12"><LINK title=2007年十一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/11"><LINK 
title=2007年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/10"><LINK title=2007年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/09"><LINK 
title=2007年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/08"><LINK title=2007年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/07"><LINK 
title=2007年六月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/06"><LINK title=2007年五月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/05"><LINK 
title=2007年四月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/04"><LINK title=2007年三月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/03"><LINK 
title=2007年二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2007/02"><LINK title=2007年一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2007/01"><LINK 
title=2006年十二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/12"><LINK title=2006年十一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/11"><LINK 
title=2006年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/10"><LINK title=2006年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/09"><LINK 
title=2006年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/08"><LINK title=2006年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/07"><LINK 
title=2006年六月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/06"><LINK title=2006年五月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/05"><LINK 
title=2006年四月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/04"><LINK title=2006年三月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/03"><LINK 
title=2006年二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2006/02"><LINK title=2006年一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2006/01"><LINK 
title=2005年十二月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2005/12"><LINK title=2005年十一月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2005/11"><LINK 
title=2005年十月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2005/10"><LINK title=2005年九月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2005/09"><LINK 
title=2005年八月 rel=archives 
href="http://www.matrix67.com/blog/archives/date/2005/08"><LINK title=2005年七月 
rel=archives href="http://www.matrix67.com/blog/archives/date/2005/07"><LINK 
title=RSD rel=EditURI type=application/rsd+xml 
href="http://www.matrix67.com/blog/xmlrpc.php?rsd"><LINK rel=wlwmanifest 
type=application/wlwmanifest+xml 
href="http://www.matrix67.com/blog/wp-includes/wlwmanifest.xml">
<META name=generator content="WordPress 2.7">
<META name=DMSGuestbook content=1.13.0><LINK rel=stylesheet type=text/css 
href="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/dmsguestbook.css" 
media=screen>
<STYLE type=text/css>.recentcomments A {
	PADDING-BOTTOM: 0px !important; MARGIN: 0px; PADDING-LEFT: 0px !important; PADDING-RIGHT: 0px !important; DISPLAY: inline !important; PADDING-TOP: 0px !important
}
</STYLE>
</HEAD>
<BODY>
<DIV id=navigation>
<UL>
  <LI class=page_item><A href="http://www.matrix67.com/blog">Home</A></LI>
  <LI class="page_item page-item-5"><A title=TagsCloud 
  href="http://www.matrix67.com/blog/tagscloud">TagsCloud</A></LI>
  <LI class="page_item page-item-485"><A title=Links 
  href="http://www.matrix67.com/blog/links">Links</A></LI>
  <LI class="page_item page-item-2"><A title=AboutMe 
  href="http://www.matrix67.com/blog/about">AboutMe</A></LI>
  <LI class="page_item page-item-2016"><A title=FAQ 
  href="http://www.matrix67.com/blog/faq">FAQ</A></LI>
  <LI class="page_item page-item-547"><A title=GuestBook 
  href="http://www.matrix67.com/blog/guestbook">GuestBook</A></LI></UL></DIV>
<DIV id=wrapper2>
<DIV id=wrapper>
<DIV id=content-wrapper>
<DIV id=content>
<DIV class=post-wrapper>
<DIV 
style="BORDER-BOTTOM: #4f5255 1px dotted; PADDING-BOTTOM: 6px; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 710px; PADDING-RIGHT: 0px; PADDING-TOP: 0px"><SPAN 
class=titles><A title="Permanent Link to 十个利用矩阵乘法解决的经典题目" 
href="http://www.matrix67.com/blog/archives/276" 
rel=bookmark>十个利用矩阵乘法解决的经典题目</A></SPAN> 
<DIV><IMG style="MARGIN-BOTTOM: -3px" alt=icon2 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/icon2.gif"> 
<A title="查看 Program Impossible 的全部文章" 
href="http://www.matrix67.com/blog/archives/category/program-impossible" 
rel="category tag">Program Impossible</A> | <IMG style="MARGIN-BOTTOM: -3px" 
alt=icon4 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/icon4.gif"> 
2007-08-04 4:01| <IMG style="MARGIN-BOTTOM: -3px" alt=icon3 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/icon3.gif">20 
Comments | 本文内容遵从<A 
href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" 
target=_blank>CC版权协议</A> 转载请注明出自matrix67.com</DIV></DIV>
<DIV class=post>
<P>&nbsp;&nbsp;&nbsp;&nbsp;好像目前还没有这方面题目的总结。这几天连续看到四个问这类题目的人，今天在这里简单写一下。这里我们不介绍其它有关矩阵的知识，只介绍矩阵乘法和相关性质。<BR>&nbsp;&nbsp;&nbsp;&nbsp;不要以为数学中的矩阵也是黑色屏幕上不断变化的绿色字符。在数学中，一个矩阵说穿了就是一个二维数组。一个n行m列的矩阵可以乘以一个m行p列的矩阵，得到的结果是一个n行p列的矩阵，其中的第i行第j列位置上的数等于前一个矩阵第i行上的m个数与后一个矩阵第j列上的m个数对应相乘后所有m个乘积的和。比如，下面的算式表示一个2行2列的矩阵乘以2行3列的矩阵，其结果是一个2行3列的矩阵。其中，结果的那个4等于2*2+0*1：<BR>&nbsp;&nbsp;&nbsp;&nbsp; 
<IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708041.gif"><BR>&nbsp;&nbsp;&nbsp;&nbsp;下面的算式则是一个1 
x 3的矩阵乘以3 x 2的矩阵，得到一个1 x 2的矩阵：<BR>&nbsp;&nbsp;&nbsp;&nbsp; <IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708042.gif"><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;矩阵乘法的两个重要性质：一，矩阵乘法<STRONG>不满足</STRONG>交换律；二，矩阵乘法满足结合律。为什么矩阵乘法不满足交换律呢？废话，交换过来后两个矩阵有可能根本不能相乘。为什么它又满足结合律呢？仔细想想你会发现这也是废话。假设你有三个矩阵A、B、C，那么(AB)C和A(BC)的结果的第i行第j列上的数都等于所有A(ik)*B(kl)*C(lj)的和（枚举所有的k和l）。<BR><BR><STRONG>经典题目1 
给定n个点，m个操作，构造O(m+n)的算法输出m个操作后各点的位置。操作有平移、缩放、翻转和旋转</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;这里的操作是对所有点同时进行的。其中翻转是以坐标轴为对称轴进行翻转（两种情况），旋转则以原点为中心。如果对每个点分别进行模拟，那么m个操作总共耗时O(mn)。利用矩阵乘法可以在O(m)的时间里把所有操作合并为一个矩阵，然后每个点与该矩阵相乘即可直接得出最终该点的位置，总共耗时O(m+n)。假设初始时某个点的坐标为x和y，下面5个矩阵可以分别对其进行平移、旋转、翻转和旋转操作。预先把所有m个操作所对应的矩阵全部乘起来，再乘以(x,y,1)，即可一步得出最终点的位置。<BR>&nbsp;&nbsp;&nbsp;&nbsp; 
<IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708043.gif"><BR><BR><STRONG>经典题目2 
给定矩阵A，请快速计算出A^n（n个A相乘）的结果，输出的每个数都mod 
p。</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;由于矩阵乘法具有结合律，因此A^4 = A * A * A * A = (A*A) 
* (A*A) = A^2 * A^2。我们可以得到这样的结论：当n为偶数时，A^n = A^(n/2) * A^(n/2)；当n为奇数时，A^n = 
A^(n/2) * A^(n/2) * A 
（其中n/2取整）。这就告诉我们，计算A^n也可以使用二分快速求幂的方法。例如，为了算出A^25的值，我们只需要递归地计算出A^12、A^6、A^3的值即可。根据<A 
href="http://www.matrix67.com/blog/article.asp?id=282" 
target=_blank>这里</A>的一些结果，我们可以在计算过程中不断取模，避免高精度运算。<BR><BR><STRONG>经典题目3 <A 
href="http://acm.pku.edu.cn/JudgeOnline/problem?id=3233" 
target=_blank>POJ3233</A></STRONG> (感谢<A 
href="http://hi.baidu.com/rangemq/blog/item/cd0b9534a57f6ab6d1a2d32b.html" 
target=_blank>rmq</A>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;题目大意：给定矩阵A，求A + A^2 + A^3 + 
... + A^k的结果（两个矩阵相加就是对应位置分别相加）。输出的数据mod 
m。k&lt;=10^9。<BR>&nbsp;&nbsp;&nbsp;&nbsp;这道题两次二分，相当经典。首先我们知道，A^i可以二分求出。然后我们需要对整个题目的数据规模k进行二分。比如，当k=6时，有：<BR>&nbsp;&nbsp;&nbsp;&nbsp;A 
+ A^2 + A^3 + A^4 + A^5 + A^6 =<U>(A + A^2 + A^3)</U> + A^3*<U>(A + A^2 + 
A^3)</U><BR>&nbsp;&nbsp;&nbsp;&nbsp;应用这个式子后，规模k减小了一半。我们二分求出A^3后再递归地计算A + A^2 + 
A^3，即可得到原问题的答案。<BR><BR><STRONG>经典题目4 <A 
href="http://www.vijos.cn/Problem_Show.asp?id=1049" 
target=_blank>VOJ1049</A></STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;题目大意：顺次给出m个置换，反复使用这m个置换对初始序列进行操作，问k次置换后的序列。m&lt;=10, 
k&lt;2^31。<BR>&nbsp;&nbsp;&nbsp;&nbsp;首先将这m个置换“合并”起来（算出这m个置换的乘积），然后接下来我们需要执行这个置换k/m次（取整，若有余数则剩下几步模拟即可）。注意任意一个置换都可以表示成矩阵的形式。例如，将1 
2 3 4置换为3 1 2 4，相当于下面的矩阵乘法：<BR>&nbsp;&nbsp;&nbsp;&nbsp; <IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708044.gif"><BR>&nbsp;&nbsp;&nbsp;&nbsp;置换k/m次就相当于在前面乘以k/m个这样的矩阵。我们可以二分计算出该矩阵的k/m次方，再乘以初始序列即可。做出来了别忙着高兴，得意之时就是你灭亡之日，别忘了最后可能还有几个置换需要模拟。<BR><BR><STRONG>经典题目5 
《算法艺术与信息学竞赛》207页（2.1代数方法和模型，[例题5]细菌，版次不同可能页码有偏差）</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;大家自己去看看吧，书上讲得很详细。解题方法和上一题类似，都是用矩阵来表示操作，然后二分求最终状态。<BR><BR><STRONG>经典题目6 
给定n和p，求第n个Fibonacci数mod 
p的值，n不超过2^31</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;根据前面的一些思路，现在我们需要构造一个2 x 
2的矩阵，使得它乘以(a,b)得到的结果是(b,a+b)。每多乘一次这个矩阵，这两个数就会多迭代一次。那么，我们把这个2 x 
2的矩阵自乘n次，再乘以(0,1)就可以得到第n个Fibonacci数了。不用多想，这个2 x 
2的矩阵很容易构造出来：<BR>&nbsp;&nbsp;&nbsp;&nbsp; <IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708045.gif"><BR><BR><STRONG>经典题目7 
<A href="http://www.vijos.cn/Problem_Show.asp?id=1067" 
target=_blank>VOJ1067</A></STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;我们可以用上面的方法二分求出任何一个线性递推式的第n项，其对应矩阵的构造方法为：在右上角的(n-1)*(n-1)的小矩阵中的主对角线上填1，矩阵第n行填对应的系数，其它地方都填0。例如，我们可以用下面的矩阵乘法来二分计算f(n) 
= 4f(n-1) - 3f(n-2) + 2f(n-4)的第k项：<BR>&nbsp;&nbsp;&nbsp;&nbsp; <IMG border=0 
alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708046.gif"><BR>&nbsp;&nbsp;&nbsp;&nbsp;利用矩阵乘法求解线性递推关系的题目我能编出一卡车来。这里给出的例题是系数全为1的情况。<BR><BR><STRONG>经典题目8 
给定一个有向图，问从A点恰好走k步（允许重复经过边）到达B点的方案数mod 
p的值</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;把给定的图转为邻接矩阵，即A(i,j)=1当且仅当存在一条边i-&gt;j。令C=A*A，那么C(i,j)=ΣA(i,k)*A(k,j)，实际上就等于从点i到点j恰好经过2条边的路径数（枚举k为中转点）。类似地，C*A的第i行第j列就表示从i到j经过3条边的路径数。同理，如果要求经过k步的路径数，我们只需要二分求出A^k即可。<BR><BR><STRONG>经典题目9 
用1 x 2的多米诺骨牌填满M x N的矩形有多少种方案，M&lt;=5，N&lt;2^31，输出答案mod 
p的结果</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp; <IMG border=0 alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/200708047.gif"><BR>&nbsp;&nbsp;&nbsp;&nbsp;我们以M=3为例进行讲解。假设我们把这个矩形横着放在电脑屏幕上，从右往左一列一列地进行填充。其中前n-2列已经填满了，第n-1列参差不齐。现在我们要做的事情是把第n-1列也填满，将状态转移到第n列上去。由于第n-1列的状态不一样（有8种不同的状态），因此我们需要分情况进行讨论。在图中，我把转移前8种不同的状态放在左边，转移后8种不同的状态放在右边，左边的某种状态可以转移到右边的某种状态就在它们之间连一根线。注意为了保证方案不重复，状态转移时我们不允许在第n-1列竖着放一个多米诺骨牌（例如左边第2种状态不能转移到右边第4种状态），否则这将与另一种转移前的状态重复。把这8种状态的转移关系画成一个有向图，那么问题就变成了这样：从状态111出发，恰好经过n步回到这个状态有多少种方案。比如，n=2时有3种方案，111-&gt;011-&gt;111、111-&gt;110-&gt;111和111-&gt;000-&gt;111，这与用多米诺骨牌覆盖3x2矩形的方案一一对应。这样这个题目就转化为了我们前面的例题8。<BR>&nbsp;&nbsp;&nbsp;&nbsp;后面我写了一份此题的源代码。你可以再次看到位运算的相关应用。<BR><BR><STRONG>经典题目10 
<A href="http://acm.pku.edu.cn/JudgeOnline/problem?id=2778" 
target=_blank>POJ2778</A></STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;题目大意是，检测所有可能的n位DNA串有多少个DNA串中不含有指定的病毒片段。合法的DNA只能由ACTG四个字符构成。题目将给出10个以内的病毒片段，每个片段长度不超过10。数据规模n&lt;=2 
000 000 
000。<BR>&nbsp;&nbsp;&nbsp;&nbsp;下面的讲解中我们以ATC,AAA,GGC,CT这四个病毒片段为例，说明怎样像上面的题一样通过构图将问题转化为例题8。我们找出所有病毒片段的前缀，把n位DNA分为以下7类：以AT结尾、以AA结尾、以GG结尾、以?A结尾、以?G结尾、以?C结尾和以??结尾。其中问号表示“其它情况”，它可以是任一字母，只要这个字母不会让它所在的串成为某个病毒的前缀。显然，这些分类是全集的一个划分（交集为空，并集为全集）。现在，假如我们已经知道了长度为n-1的各类DNA中符合要求的DNA个数，我们需要求出长度为n时各类DNA的个数。我们可以根据各类型间的转移构造一个边上带权的有向图。例如，从AT不能转移到AA，从AT转移到??有4种方法（后面加任一字母），从?A转移到AA有1种方案（后面加个A），从?A转移到??有2种方案（后面加G或C），从GG到??有2种方案（后面加C将构成病毒片段，不合法，只能加A和T）等等。这个图的构造过程类似于用有限状态自动机做串匹配。然后，我们就把这个图转化成矩阵，让这个矩阵自乘n次即可。最后输出的是从??状态到所有其它状态的路径数总和。<BR>&nbsp;&nbsp;&nbsp;&nbsp;题目中的数据规模保证前缀数不超过100，一次矩阵乘法是三方的，一共要乘log(n)次。因此这题总的复杂度是100^3 
* 
log(n)，AC了。<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;最后给出第9题的代码供大家参考（今天写的，熟悉了一下C++的类和运算符重载）。为了避免大家看代码看着看着就忘了，我把这句话放在前面来说：<BR>&nbsp;&nbsp;&nbsp;&nbsp;Matrix67原创，转贴请注明出处。<BR><BR><CODE>#include 
&lt;cstdio&gt;<BR>#define SIZE (1&lt;&lt;m)<BR>#define MAX_SIZE 32<BR>using 
namespace std;<BR><BR>class 
CMatrix<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;public:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long 
element[MAX_SIZE][MAX_SIZE];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void 
setSize(int);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void 
setModulo(int);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMatrix 
operator* (CMatrix);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMatrix 
power(int);<BR>&nbsp;&nbsp;&nbsp;&nbsp;private:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int 
size;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long 
modulo;<BR>};<BR><BR>void CMatrix::setSize(int 
a)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;for (int i=0; i&lt;a; 
i++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (int j=0; j&lt;a; 
j++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element[i][j]=0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;size 
= a;<BR>}<BR><BR>void CMatrix::setModulo(int 
a)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;modulo = a;<BR>}<BR><BR>CMatrix 
CMatrix::operator* (CMatrix param)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;CMatrix 
product;<BR>&nbsp;&nbsp;&nbsp;&nbsp;product.setSize(size);<BR>&nbsp;&nbsp;&nbsp;&nbsp;product.setModulo(modulo);<BR>&nbsp;&nbsp;&nbsp;&nbsp;for 
(int i=0; i&lt;size; i++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 
(int j=0; j&lt;size; 
j++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 
(int k=0; k&lt;size; 
k++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product.element[i][j]+=element[i][k]*param.element[k][j];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product.element[i][j]%=modulo;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;return 
product;<BR>}<BR><BR>CMatrix CMatrix::power(int 
exp)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;CMatrix tmp = (*this) * 
(*this);<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (exp==1) return 
*this;<BR>&nbsp;&nbsp;&nbsp;&nbsp;else if (exp &amp; 1) return tmp.power(exp/2) 
* (*this);<BR>&nbsp;&nbsp;&nbsp;&nbsp;else return 
tmp.power(exp/2);<BR>}<BR><BR><BR>int 
main()<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;const int 
validSet[]={0,3,6,12,15,24,27,30};<BR>&nbsp;&nbsp;&nbsp;&nbsp;long n, m, 
p;<BR>&nbsp;&nbsp;&nbsp;&nbsp;CMatrix 
unit;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;scanf("%d%d%d", 
&amp;n, &amp;m, 
&amp;p);<BR>&nbsp;&nbsp;&nbsp;&nbsp;unit.setSize(SIZE);<BR>&nbsp;&nbsp;&nbsp;&nbsp;for(int 
i=0; i&lt;SIZE; i++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int 
j=0; j&lt;SIZE; 
j++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( 
((~i)&amp;j) == ((~i)&amp;(SIZE-1)) 
)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool 
isValid=false;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 
(int k=0; k&lt;8; 
k++)isValid=isValid||(i&amp;j)==validSet[k];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unit.element[i][j]=isValid;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;unit.setModulo(p);<BR>&nbsp;&nbsp;&nbsp;&nbsp;printf("%d", 
unit.power(n).element[SIZE-1][SIZE-1] );<BR>&nbsp;&nbsp;&nbsp;&nbsp;return 
0;<BR>}</CODE></P>
<DIV style="MARGIN: 4px 0px 6px -6px">
<SCRIPT type=text/javascript><!--
		google_ad_client = "pub-8918918108662869";
		/* 728x90, 创建于 08-4-2 */
		google_ad_slot = "5288878306";
		google_ad_width = 728;
		google_ad_height = 90;
	//-->
	</SCRIPT>

<SCRIPT type=text/javascript 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/show_ads.js">
	</SCRIPT>
</DIV>
<DIV class=post-footer>Posted in <A title="查看 Program Impossible 的全部文章" 
href="http://www.matrix67.com/blog/archives/category/program-impossible" 
rel="category tag">Program Impossible</A> <BR>Tags: <A 
href="http://www.matrix67.com/blog/archives/tag/c%e8%af%ad%e8%a8%80" 
rel=tag>C语言</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e7%9f%a9%e9%98%b5" 
rel=tag>矩阵</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e7%ae%97%e6%b3%95" 
rel=tag>算法</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e8%b6%a3%e9%a2%98" 
rel=tag>趣题</A>, <A href="http://www.matrix67.com/blog/archives/tag/poj" 
rel=tag>POJ</A>, <A href="http://www.matrix67.com/blog/archives/tag/vijos" 
rel=tag>Vijos</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e5%88%86%e6%b2%bb" 
rel=tag>分治</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e5%8a%a8%e6%80%81%e8%a7%84%e5%88%92" 
rel=tag>动态规划</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e5%9b%be%e8%ae%ba" 
rel=tag>图论</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e6%95%b0%e5%88%97" 
rel=tag>数列</A>, <A 
href="http://www.matrix67.com/blog/archives/tag/%e4%bd%8d%e8%bf%90%e7%ae%97" 
rel=tag>位运算</A><BR>Trackback: 
http://www.matrix67.com/blog/archives/276/trackback<BR><STRONG>我猜您可能还喜欢：</STRONG><BR>
<UL>
  <LI><A title=2008-04-22 href="http://www.matrix67.com/blog/archives/500" 
  rel=bookmark>矩阵、随机化与分形图形</A></LI>
  <LI><A title=2009-05-18 href="http://www.matrix67.com/blog/archives/1890" 
  rel=bookmark>记09年北大ACM校内赛</A></LI>
  <LI><A title=2006-09-26 href="http://www.matrix67.com/blog/archives/108" 
  rel=bookmark>什么是离散化？</A></LI>
  <LI><A title=2006-07-04 href="http://www.matrix67.com/blog/archives/97" 
  rel=bookmark>OOJ网址大暴光及试用报告</A></LI>
  <LI><A title=2006-10-07 href="http://www.matrix67.com/blog/archives/110" 
  rel=bookmark>无题 于2006年10月7日</A></LI>
  <LI><A title=2008-01-25 href="http://www.matrix67.com/blog/archives/424" 
  rel=bookmark>趣题：一个与Hamilton回路有关的问题</A></LI>
  <LI><A title=2008-08-02 href="http://www.matrix67.com/blog/archives/598" 
  rel=bookmark>一个与矩形剖分有关的命题（四）：简便的数论证明</A></LI>
  <LI><A title=2008-07-25 href="http://www.matrix67.com/blog/archives/564" 
  rel=bookmark>一个与矩形剖分有关的命题（二）：直观的图论证明</A></LI></UL><!-- Similar Posts took 126.531 ms --></DIV></DIV></DIV><!-- You can start editing here. --><A 
name=comments></A>
<H2 style="MARGIN-TOP: 4px; BORDER-TOP: #4f5255 1px dotted; PADDING-TOP: 6px">20 
条回复</H2>
<UL class=commentlist>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 沙发 | <SMALL class=commentmetadata>2007-08-04 
  8:42 </SMALL>| <A name=comment-1228></A>windywinter 说： 
  <P>重载双目运算符尽量放到类定义的外面，以避免不同编译器的区别。</P>
  <P><SPAN style="COLOR: red">回复：谢谢指点；这方面的东西我还不太熟，过几天来研究</SPAN></P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 板凳 | <SMALL class=commentmetadata>2007-08-04 
  8:43 </SMALL>| <A name=comment-1229></A>windywinter 说： 
  <P>另外，matrix67大牛为什么不写一个矩阵快速乘法呢？这个一直弄不明白怎么做。</P>
  <P><SPAN style="COLOR: red">回复：是不是这个？<BR><A 
  href="http://www.comp.nus.edu.sg/~xujia/mirror/algorithm.myrice.com/algorithm/commonalg/misc/strassen/strassen.htm" 
  rel=nofollow>http://www.comp.nus.edu.sg/~xujia/mirror/algorithm.myrice.com/algorithm/commonalg/misc/strassen/strassen.htm</A></SPAN></P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地毯 | <SMALL class=commentmetadata>2007-08-05 
  20:31 </SMALL>| <A name=comment-1230></A>yiyi 说： 
  <P>第6题的那个用矩阵乘法求第n个Fibonacci数的算法很感兴趣，可看的还是不大明白，能说的再详细一点吗？</P>
  <P><SPAN 
  style="COLOR: red">回复：usera.imagecave.com/matrix67/fib_using_matrix.GIF</SPAN></P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地板 | <SMALL class=commentmetadata>2007-08-10 
  20:08 </SMALL>| <A name=comment-1231></A>lsylsy2 说： 
  <P>矩阵=matrix</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地下室 | <SMALL class=commentmetadata>2007-08-17 
  22:51 </SMALL>| <A name=comment-1232></A>Kimm 说： 
  <P>经典题目9 能否再解释下<BR>看不是很懂<BR>左边的状态是怎么转移到右边的<BR>111又是怎么转移到011的？</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地基 | <SMALL class=commentmetadata>2007-10-21 
  13:56 </SMALL>| <A name=comment-1233></A>hey 说： 
  <P>给个建议, 规范 C++ 书写.<BR>#include &lt;cstdio&gt;, #define, scanf, printf 
  之类的东西不该出现哦.</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地壳 | <SMALL class=commentmetadata>2007-11-15 
  16:36 </SMALL>| <A name=comment-1234></A>晗熙 说： 
  <P>第九题&nbsp;&nbsp;超经典<BR>能否写个pascal???</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地幔 | <SMALL class=commentmetadata>2008-01-13 
  16:43 </SMALL>| <A name=comment-1235></A>rmq 说： 
  <P>啊，太荣幸了，大牛居然贴我blog上的一个小题目 ~~<BR>太开心了</P>
  <P><SPAN style="COLOR: red">回复：您牛的blog我每天都上，都是经典题目啊</SPAN></P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(1).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 地核 | <SMALL class=commentmetadata>2008-06-30 
  14:16 </SMALL>| <A name=comment-60927></A>shinefine 说： 
  <P>楼主能把下面这个数列用矩阵的方式求出第n项的值吗？<BR>数列用递归方式定义：<BR>Q(1)= Q(2) 
  =1<BR>Q(N)=Q(N-Q(N-1))+Q(N-Q(N-2)) (N&gt;2)</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(2).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 10楼 | <SMALL class=commentmetadata>2008-09-24 
  19:30 </SMALL>| <A name=comment-171619></A>Tsuji 说： 
  <P>楼上的数列好象在VIJOS上看到过</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(3).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 11楼 | <SMALL class=commentmetadata>2008-10-25 
  0:07 </SMALL>| <A name=comment-173115></A><A class=url 
  href="http://liuyue.co.cc/" rel="external nofollow">Excessuz</A> 说： 
  <P>其实类的双目运算符好像可以在类里面定义成友元函数……和在类外定义是等效的……这样看起来可能会比较舒服……</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(4).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 12楼 | <SMALL class=commentmetadata>2008-12-15 
  4:41 </SMALL>| <A name=comment-175744></A><A class=url 
  href="http://www.teole.info/bdsm-real-pain" 
  rel="external nofollow">Melissa</A> 说： 
  <P>Found your site in google, and it has a lot of usefull information. 
  Thanx.h</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(5).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 12a楼 | <SMALL class=commentmetadata>2008-12-25 
  21:38 </SMALL>| <A name=comment-176321></A><A class=url 
  href="http://www.burlwood.org/" rel="external nofollow">burl wood</A> 说： 
  <P>Good Site</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(6).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 14楼 | <SMALL class=commentmetadata>2009-01-30 
  16:17 </SMALL>| <A name=comment-177816></A>cloudygoose 说： 
  <P>最后一题能再讲得详细的吗？完全不理解。<BR>“<BR>以AT结尾、以AA结尾、以GG结尾、以?A结尾、以?G结尾、以?C结尾和以??结尾<BR>”<BR>是怎么得出的？</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(7).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 15楼 | <SMALL class=commentmetadata>2009-04-03 
  22:30 </SMALL>| <A name=comment-181344></A><A class=url 
  href="http://hi.baidu.com/winterlegend" rel="external nofollow">Vector·Sun</A> 
  说： 
  <P>最后一题真的不好理解……<BR>若能把所有状态之间的关系（即那个矩阵）列出来就好了</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(8).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 16楼 | <SMALL class=commentmetadata>2009-04-08 
  13:03 </SMALL>| <A name=comment-181503></A>andyhua__88 说： 
  <P>请问第4个题目中是对每个置换转换成n*n的矩阵，然后对每个矩阵相乘吗？如果是这样，当n=100时，时间复杂度也会达到n^3,最少也会是7^(logn),不会超时吗？</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 17楼 | <SMALL class=commentmetadata>2009-05-18 
  18:50 </SMALL>| <A name=comment-182700></A><A class=url 
  href="http://www.matrix67.com/blog/archives/1890" 
  rel="external nofollow">Matrix67: My Blog » Blog Archive » 记09年北大ACM校内赛</A> 说： 

  <P>[...] 
  &nbsp;&nbsp;&nbsp;&nbsp;但这一思路碰到了一些困难：交换和清零操作都好办，但加一操作怎么弄？我们可以借用这里的第二题的思路，在猫猫向量的最后面加一个额外的“1”，从而解决了加一操作的难题。 
  [...]</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(9).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 18楼 | <SMALL class=commentmetadata>2009-07-26 
  0:57 </SMALL>| <A name=comment-184912></A><A class=url 
  href="http://blog.sina.com.cn/snowingbluesky" 
  rel="external nofollow">topsky</A> 说： 
  <P>题目3<BR>构造一个矩阵<BR>A I<BR>O I<BR>自乘后<BR>A^2 I+A<BR>O I<BR>乘3次为<BR>A^3 
  I+A+A^2<BR>O I<BR>这样应该会更快吧，直接二分一下。</P></DIV></LI>
  <LI class=graybox>
  <DIV class=avatar><IMG class="avatar avatar-48 photo" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536(10).png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 19楼 | <SMALL class=commentmetadata>2009-09-12 
  13:17 </SMALL>| <A name=comment-187032></A>箜 说： 
  <P>第九题能不能给我一个Pascal程序，我看不懂C++</P></DIV></LI>
  <LI>
  <DIV class=avatar><IMG class="avatar avatar-48 photo avatar-default" alt="" 
  src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/ad516503a11cd5ca435acc9bb6523536.png" 
  width=48 height=48></DIV>
  <DIV class=comment-content>楼层: 20楼 | <SMALL class=commentmetadata>2010-07-18 
  11:48 </SMALL>| <A name=comment-198908></A><A class=url 
  href="http://bchine.com/mjmjmtl/?p=273" rel="external nofollow">Matrix小结 « 
  mjmjmtl</A> 说： 
  <P>[...] 
  矩阵乘法是可以通过利用二进制进行加速的，应用这一技巧可以快速解决矩阵乘法以及类矩阵乘法的问题（比如最短路径的问题，只要形式类似于矩阵乘法，就可以当成矩阵乘法来用）。推广的问题，可以解决斐波那契数列等问题。最好的总结没过与Matrix67大牛的那篇文章《十个利用矩阵乘法解决的经典题目》。原文如下： 
  [...]</P></DIV></LI></UL><A name=respond></A>
<H3>您也随便说几句吧：</H3>
<FORM id=commentform method=post 
action=http://www.matrix67.com/blog/wp-comments-post.php>
<P><INPUT id=author class=styled tabIndex=1 size=22 type=text name=author> 
<LABEL for=author>您的昵称（必填）</LABEL> <INPUT value=276 type=hidden 
name=comment_post_ID> <INPUT value=/blog/archives/276 type=hidden 
name=redirect_to></P>
<P><INPUT id=email tabIndex=2 size=22 type=text name=email> <LABEL 
for=email>您的E-mail地址（必填）</LABEL></P>
<P><INPUT id=url tabIndex=3 size=22 type=text name=url> <LABEL 
for=url>您的网站（可选）</LABEL></P><!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->
<P><TEXTAREA id=comment tabIndex=4 rows=5 cols=100 name=comment></TEXTAREA></P>
<P>您可以在 <A href="http://gravatar.com/" target=_blank>Gravatar</A> 设置您的头像。</P>
<P><INPUT id=submit tabIndex=5 value=提交评论 type=submit name=submit></P></FORM>
<P class=pagination></P></DIV></DIV>
<DIV id=sidebar-wrapper>
<DIV id=sidebar>
<DIV class=sideblock>
<H3>Category</H3>
<UL>
  <LI class="cat-item cat-item-12"><A title="查看 Brain Storm 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/brain-storm">Brain 
  Storm</A> (407) </LI>
  <LI class="cat-item cat-item-14"><A title="查看 Design of Design 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/design-of-design">Design 
  of Design</A> (45) </LI>
  <LI class="cat-item cat-item-10"><A title="查看 Internet Vision 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/internet-vision">Internet 
  Vision</A> (131) </LI>
  <LI class="cat-item cat-item-11"><A title="查看 Movie Time 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/movie-time">Movie 
  Time</A> (47) </LI>
  <LI class="cat-item cat-item-9"><A title="查看 Program Impossible 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/program-impossible">Program 
  Impossible</A> (145) </LI>
  <LI class="cat-item cat-item-8"><A title="查看 This is My Life 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/this-is-my-life">This is 
  My Life</A> (98) </LI>
  <LI class="cat-item cat-item-13"><A title="查看 Tough Computer 下的所有文章" 
  href="http://www.matrix67.com/blog/archives/category/tough-computer">Tough 
  Computer</A> (28) </LI></UL></DIV>
<DIV class=sideblock>
<H3>Subscribe</H3>
<DIV class=textwidget><A 
style="MARGIN-TOP: -18px; FLOAT: right; MARGIN-RIGHT: 12px" 
title="Matrix67: My Blog" href="http://www.matrix67.com/blog/feed.asp"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
alt="" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/orange_e.gif"></A> 

<UL>
  <LI><A 
  href="http://www.zhuaxia.com/add_channel.php?url=http://www.matrix67.com/blog/feed.asp" 
  target=_blank>抓虾</A></LI>
  <LI><A href="http://www.anothr.com/add?url=http://www.matrix67.com/blog/" 
  target=_blank>哪吒</A></LI>
  <LI><A 
  href="http://www.xianguo.com/subscribe.php?url=http%3A%2F%2Fwww.matrix67.com%2Fblog" 
  target=_blank>鲜果</A></LI>
  <LI><A href="http://sofa.souyo.com/add?f=http://www.matrix67.com/blog/" 
  target=_blank>沙发</A></LI>
  <LI><A href="http://www.live.com/?add=http://www.matrix67.com/blog/feed.asp" 
  target=_blank>Live</A></LI>
  <LI><A 
  href="http://www.google.com/ig/add?feedurl=http://www.matrix67.com/blog/feed.asp" 
  target=_blank>Google</A></LI>
  <LI><A 
  href="http://www.netvibes.com/subscribe.php?type=rss&amp;url=http://www.matrix67.com/blog/feed.asp" 
  target=_blank>Netvibes</A></LI>
  <LI><A 
  href="http://www.bloglines.com/sub/http://www.matrix67.com/blog/feed.asp" 
  target=_blank>Bloglines</A></LI></UL></DIV></DIV>
<DIV class=sideblock>
<H3>Control Panel</H3>
<UL>
  <LI><A href="http://www.matrix67.com/blog/wp-login.php">登录</A></LI>
  <LI><A title="使用 RSS 2.0 同步此内容" 
  href="http://www.matrix67.com/blog/feed.asp">文章 <ABBR 
  title="Really Simple Syndication">RSS</ABBR></A></LI>
  <LI><A title="RSS 上的最近评论" 
  href="http://www.matrix67.com/blog/comments/feed"><ABBR 
  title="Really Simple Syndication">RSS</ABBR> 评论</A></LI></UL></DIV>
<DIV class=sideblock>
<H3>Random Articles</H3>
<UL>
  <LI><A title="本来想写一段有趣的翻译，发现有�...  17.12.2007" 
  href="http://www.matrix67.com/blog/archives/385" 
  rel=bookmark>编程世界的20个怪物</A></LI>
  <LI><A title="&nbsp;&nbsp;&nbsp;&nbsp;我在学校时，时�...  28.07.2008" 
  href="http://www.matrix67.com/blog/archives/572" 
  rel=bookmark>设计调查问卷的艺术：怎样才能绝对地保证个人隐私不被泄露</A></LI>
  <LI><A title="&nbsp;&nbsp;&nbsp;&nbsp;N多人抱怨说Mathem...  18.08.2008" 
  href="http://www.matrix67.com/blog/archives/653" 
  rel=bookmark>Mathway：对付数学作业的新武器</A></LI>
  <LI><A title="&nbsp;&nbsp;&nbsp;&nbsp;在没有Mathematica��...  6.01.2008" 
  href="http://www.matrix67.com/blog/archives/410" 
  rel=bookmark>巨牛B的在线数学工具：反符号计算器</A></LI>
  <LI><A title="&nbsp;&nbsp;&nbsp;&nbsp;你认为，是否有�...  6.04.2009" 
  href="http://www.matrix67.com/blog/archives/1684" 
  rel=bookmark>趣题：对全体正整数红蓝二着色使之不含单色无穷等差数列</A></LI>
  <LI><A 
  title="&#13;&#10;&#13;&#10;有人觉得眼熟吗？&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;View Large...  21.12.2008" 
  href="http://www.matrix67.com/blog/archives/1153" 
  rel=bookmark>猜猜看这是什么地方？</A></LI>
  <LI><A 
  title="&#13;&#10;SCOOPING THE LOOP SNOOPER&#13;&#10;A proof that the ...  5.03.2009" 
  href="http://www.matrix67.com/blog/archives/1497" 
  rel=bookmark>史上最牛诗歌：一个停机问题不可判定的证明</A></LI>
  <LI><A title="&nbsp;&nbsp;&nbsp;&nbsp;在1717年，法国流...  9.01.2008" 
  href="http://www.matrix67.com/blog/archives/412" rel=bookmark>概率学的创立：Chevalier 
  de Méré问题</A></LI></UL></DIV>
<DIV class=sideblock>
<H3>Recent Comments</H3>
<UL id=recentcomments>
  <LI class=recentcomments>P.K. 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201565">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments>firewalk 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201564">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments><A class=url href="http://www.spongeliu.com/" 
  rel="external nofollow">sponge</A> 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201563">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments><A class=url href="http://www.wang3feng.com/" 
  rel="external nofollow">眯眯熊</A> 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201562">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments>pai 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201561">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments>loki 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201560">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments>zrp 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201559">趣题：用树来表示数</A> 
  上的评论</LI>
  <LI class=recentcomments>zrp 在 <A 
  href="http://www.matrix67.com/blog/archives/3819/comment-page-1#comment-201558">趣题：用树来表示数</A> 
  上的评论</LI></UL></DIV>
<DIV class=sideblock>
<H3>Search</H3>
<FORM id=searchform method=get action=http://www.matrix67.com/blog>
<DIV><INPUT id=s size=15 type=text name=s> <INPUT value=搜索 type=submit> 
</DIV></FORM></DIV>
<DIV class=sideblock>
<H3>Blogroll</H3>
<UL class="xoxo blogroll">
  <LI><A href="http://blog.youxu.info/" target=_blank>4G Spaces</A></LI>
  <LI><A href="http://aifreedom.com/" target=_blank>Ai.Freedom</A></LI>
  <LI><A href="http://asukanokaze.blogbus.com/" rel="friend met" 
  target=_blank>AsukaNoKaze</A></LI>
  <LI><A href="http://www.eaglefantasy.cn/" target=_blank>EagleFantasy</A></LI>
  <LI><A href="http://mindhacks.cn/" target=_blank>MindHacks</A></LI>
  <LI><A href="http://cuitianyi.com/blog/" rel=friend 
  target=_blank>Tianyi</A></LI>
  <LI><A href="http://yueweitang.org/blog/" 
target=_blank>Zhiqiang</A></LI></UL></DIV>
<DIV class=sideblock>
<H3>Support</H3>
<DIV class=textwidget>
<P><A href="http://validator.w3.org/check/referer" target=_blank><IMG border=0 
alt="XHTML 1.0 Transitional" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/xhtml.png"></A> 
<A href="http://jigsaw.w3.org/css-validator/validator-uri.html" 
target=_blank><IMG border=0 alt="Css Validator" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/css.gif"></A> 
<A href="http://www.matrix67.com/blog/archives/feed.asp" target=_blank><IMG 
border=0 alt="RSS 2.0" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/rss2.png"></A> 
<A href="http://www.matrix67.com/blog/archives/atom.asp" target=_blank><IMG 
border=0 alt="Atom 1.0" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/atom.png"></A> 
<A href="http://www.mozilla.org/products/firefox/" target=_blank><IMG border=0 
alt="Get firefox" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/firefox.gif"></A> 
<A href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" 
target=_blank><IMG border=0 alt="Creative Commons" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/cc.png"></A> 
<A href="msnim:chat?contact=matrix67@tom.com" target=_blank><IMG border=0 
alt=MSN 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/msnicon.gif"></A> 
<A href="mailto:gs.matrix67@gmail.com" target=_blank><IMG border=0 alt=GmailMe 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/gmailme.gif"></A> 
<A 
href="http://wpa.qq.com/msgrd?V=1&amp;Uin=188932899&amp;Site=www.matrix67.com&amp;Menu=yes" 
target=_blank><IMG border=0 alt=QQ 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/QQ.gif"></A> 
<A href="http://del.icio.us/matrix67" target=_blank><IMG border=0 
alt="My del.icio.us" 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/my-del.icio.us.gif"></A> 
<A href="http://www.imdb.com/mymovies/list?l=19073540" target=_blank><IMG 
border=0 alt=imdb 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/imdb.png"></A> 
<A href="http://www.last.fm/user/matrix67" target=_blank><IMG border=0 
alt=Last.fm 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/lastfm.gif"></A></P>
<P>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-8918918108662869";
google_ad_slot = "8802076064";
google_ad_width = 160;
google_ad_height = 600;
//-->
</SCRIPT>

<SCRIPT type=text/javascript 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/show_ads.js">
</SCRIPT>
</P><BR></DIV></DIV></DIV></DIV></DIV>
<DIV id=footer>
<P>Powered by <A href="http://wordpress.org/" target=_blank>WordPress</A>. Theme 
by <A href="http://www.smartertemplates.com/" target=_blank>Smarter 
Templates</A> &amp; <A href="http://webhostinggeeks.com/" target=_blank>Web 
Hosting Geeks</A>, Revised by <A 
href="http://www.matrix67.com/">Matrix67.com</A><BR><A title="使用 RSS 同步" 
href="http://www.matrix67.com/blog/feed.asp">Entries <ABBR 
title="Really Simple Syndication">RSS</ABBR></A> | <A title="RSS 上的最近评论" 
href="http://www.matrix67.com/blog/comments/feed">Comments <ABBR 
title="Really Simple Syndication">RSS</ABBR></A></P></DIV></DIV>
<SCRIPT language=javascript type=text/javascript>
//<![CDATA[
function listExpand(list)
{
   list.style.height="auto";
   list.style.overflow="visible";
   list.style.backgroundColor="#404449";
}
function listContract(list)
{
   list.style.height="16px";
   list.style.overflow="hidden";
   list.style.backgroundColor="#2C2F33";
}
var els = document.getElementsByTagName("li");
for (var i = 0; i < els.length; i++)
{
   if (els[i].parentNode.parentNode.className=="sideblock"
      || els[i].parentNode.parentNode.className=="textwidget")
   { 
     els[i].onmouseover = function(){listExpand(this)};
     els[i].onmouseout = function(){listContract(this)};
   }
}
  //]]>
</SCRIPT>

<DIV style="DISPLAY: none">
<SCRIPT language=JavaScript type=text/javascript charset=gb2312 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/stat.htm">
</SCRIPT>
</DIV>
<SCRIPT type=text/javascript 
src="Matrix67%20My%20Blog%20»%20Blog%20Archive%20»%20十个利用矩阵乘法解决的经典题目_files/urchin.js">
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1093817-1";
urchinTracker();
</SCRIPT>
<!-- Dynamic Page Served (once) in 2.439 seconds --><!-- Cached page generated by WP-Super-Cache on 2010-10-12 20:36:45 --><!-- super cache --></BODY></HTML>
